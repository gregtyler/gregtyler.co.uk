<!DOCTYPE html>
<html lang="en" dir="ltr">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <meta name="theme-color" content="#c82e14">
    <link rel="preconnect" href="https://analytics.gregtyler.co.uk">
    <link rel="manifest" href="/assets/manifest.webmanifest">
    <link rel="shortcut icon" href="/assets/favicon.png">
    <link rel="apple-touch-icon" href="/assets/favicon-192.png" />
    <link rel="alternate" type="application/rss+xml" title="Greg Tyler RSS Feed" href="/feed.rss" />
    <meta name="description" content="Websites, quizzes, problem solving. I try to make stuff better.">
    
<title>When is a window closable? - Greg Tyler</title>
<link rel="canonical" href="https://gregtyler.co.uk/blog/when-is-a-window-closable" />
<meta name="twitter:card" content="summary" />
<meta name="twitter:site" content="@gregtyler" />
<meta name="twitter:creator" content="@gregtyler" />
<meta name="og:url" content="https://gregtyler.co.uk/blog/when-is-a-window-closable" />
<meta name="og:title" content="When is a window closable?" />
<meta name="og:description" content="<p>JavaScript has a function window.close() which, under certain circumstances, will close the current window. However sometimes you&#39;ll run into an error like: Scripts may close only the windows that were opened by it. In this situation, your helpful &quot;close this window&quot; buttons don&#39;t work. We have exactly this in situation in a current project I [&hellip;]</p>
" />


    <style type="text/css">:root{--spacing:1rem;--color-brand:#c82e14;--color-brand-dark:#a82e14;--color-brand-contrast:#fff;--color-subbrand:#fbbf13;--color-link:#3973b1;--color-text:#555;--color-accent:#f5f5f5;--font-default:-apple-system,BlinkMacSystemFont,Segoe UI,Helvetica,Arial,sans-serif}@media (min-width:1000px){:root{--spacing:1.5rem}}@media (min-width:1500px){:root{--spacing:1.75rem}}*,:after,:before{box-sizing:border-box}a{color:#3973b1;color:var(--color-link)}body{display:flex;flex-direction:column;min-height:100vh;margin:0;font-family:-apple-system,BlinkMacSystemFont,Segoe UI,Helvetica,Arial,sans-serif;font-family:var(--font-default);font-size:18px;background-color:#c82e14;background-color:var(--color-brand);background-image:radial-gradient(at 7rem,at 3rem,#a82e14 5%,#c82e14 30%,#c82e14 70%,#fbbf13);background-image:radial-gradient(at 7rem 3rem,#a82e14 5%,#c82e14 30%,#c82e14 70%,#fbbf13);background-image:radial-gradient(at 7rem,at 3rem,var(--color-brand-dark) 5%,var(--color-brand) 30%,var(--color-brand) 70%,var(--color-subbrand));background-image:radial-gradient(at 7rem 3rem,var(--color-brand-dark) 5%,var(--color-brand) 30%,var(--color-brand) 70%,var(--color-subbrand));background-repeat:no-repeat;color:#555;color:var(--color-text);letter-spacing:-.03em}::-moz-selection{background-color:#c82e14;background-color:var(--color-brand);color:#fff;color:var(--color-brand-contrast)}::selection{background-color:#c82e14;background-color:var(--color-brand);color:#fff;color:var(--color-brand-contrast)}h1{margin:0}hr{border-top:1px solid #ccc;border-bottom:0}pre{overflow-x:auto}.o-carousel{display:grid;grid-template-columns:repeat(auto-fit,minmax(250px,1fr));justify-content:stretch;grid-gap:1rem;grid-gap:var(--spacing);grid-auto-rows:1fr}.o-linklist{display:flex;margin:0;padding:0;list-style-type:none}.o-linklist--vertical{flex-direction:column}.o-linklist--horizontal{flex-direction:row}.o-linklist--centered{justify-content:center}.o-linklist__link{display:block;padding:.5rem;padding:calc(var(--spacing)*0.5);color:inherit;text-decoration:none}.o-linklist__link:hover{text-decoration:underline}.c-card{display:inline-flex;padding:1rem;padding:var(--spacing);background-color:#fff;flex-direction:column;box-shadow:0 0 3px rgba(0 0 0/20%)}.c-card--link{color:#555;color:var(--color-text);text-decoration:none;transition:all .4s linear}.c-card--link:hover{background-color:#eee}.c-card__title{margin:0;font-size:1.2rem}.c-card__meta{color:#777;font-size:.9rem}.c-card__actions{text-align:right}.c-card__action{margin-left:1rem;margin-left:var(--spacing);font-size:.85rem;text-transform:uppercase}.c-card__action:hover{text-decoration:underline}.c-card__action--primary{color:#c82e14;color:var(--color-brand)}.c-card:hover .c-card__action--primary{text-decoration:underline}.c-footer{padding:1rem;padding:var(--spacing);color:#fff;color:var(--color-brand-contrast);font-family:1.5rem;text-align:center}.c-footer__link{color:inherit;font-size:.85rem}.c-navbar{display:flex;flex-direction:column;width:100%;padding:1rem;padding:var(--spacing);color:#fff;color:var(--color-brand-contrast);align-items:center;justify-content:space-between}.c-navbar__title-link{color:inherit;text-decoration:none}@media (min-width:500px){.c-navbar{flex-direction:row}}.c-page{padding:1rem;padding:var(--spacing);background-color:#fff;color:#555;color:var(--color-text)}.c-page__title{margin-bottom:1rem;margin-bottom:var(--spacing);text-align:center;font-size:2rem;line-height:1em}.c-page__meta{margin-left:-1rem;margin-left:calc(var(--spacing)*-1);margin-right:-1rem;margin-right:calc(var(--spacing)*-1);padding-top:1rem;padding-top:var(--spacing);padding-bottom:1rem;padding-bottom:var(--spacing);text-align:center;background-color:#f5f5f5;background-color:var(--color-accent)}.c-page__content{max-width:40rem;margin:0 auto;font-size:1.1rem;line-height:1.4em}@media (min-width:1000px){.c-page{padding:2rem;padding:calc(var(--spacing)*2)}.c-page__title{margin-bottom:2rem;margin-bottom:calc(var(--spacing)*2);font-size:3rem}.c-page__meta{margin-left:-2rem;margin-left:calc(var(--spacing)*-2);margin-right:-2rem;margin-right:calc(var(--spacing)*-2)}.c-page__content{font-size:1.2rem;line-height:1.5em}}.c-splash{display:flex;flex:1;align-items:center;justify-content:center;min-height:50vmin;color:#fff;color:var(--color-brand-contrast);font-size:8vmin;font-weight:300;text-transform:uppercase;letter-spacing:-.05em}.c-sunken{background-color:#ccc;box-shadow:inset 0 5px 10px -5px rgba(0 0 0/60%),inset 0 -5px 10px -5px rgba(0 0 0/60%);padding:1rem;padding:var(--spacing)}.c-sunken__title{margin-top:0;margin-bottom:1rem;margin-bottom:var(--spacing)}.c-tag{margin:.2rem;margin:calc(var(--spacing)*0.2);padding:.1rem .3rem;padding:calc(var(--spacing)*0.1) calc(var(--spacing)*0.3);background-color:#a82e14;background-color:var(--color-brand-dark);color:#fff;color:var(--color-brand-contrast);font-size:.85rem;text-decoration:none}.t-flex--fill{flex-grow:1}.hljs-comment,.hljs-quote{color:#969896}.hljs-deletion,.hljs-name,.hljs-regexp,.hljs-selector-class,.hljs-selector-id,.hljs-tag,.hljs-template-variable,.hljs-variable{color:#c66}.hljs-built_in,.hljs-builtin-name,.hljs-link,.hljs-literal,.hljs-meta,.hljs-number,.hljs-params,.hljs-type{color:#de935f}.hljs-attribute{color:#f0c674}.hljs-addition,.hljs-bullet,.hljs-string,.hljs-symbol{color:#b5bd68}.hljs-section,.hljs-title{color:#81a2be}.hljs-keyword,.hljs-selector-tag{color:#b294bb}.hljs{display:block;overflow-x:auto;background:#1d1f21;color:#c5c8c6;padding:.5em}.hljs-emphasis{font-style:italic}.hljs-strong{font-weight:700}.wp-caption{max-width:100%;background-color:#eee}@media (min-width:1000px){.alignleft,.alignright{max-width:60%}.alignleft{float:left;margin-left:-20%;margin-right:1rem;margin-right:var(--spacing)}.alignright{float:right;margin-right:-20%;margin-left:1rem;margin-left:var(--spacing)}}[class*=wp-image-]{max-width:100%;height:auto!important}.size-full{display:block;margin-left:auto;margin-right:auto}.wp-caption-text{margin-bottom:0;padding-left:1rem;padding-left:var(--spacing);padding-right:1rem;padding-right:var(--spacing);padding-bottom:1rem;font-size:1rem;line-height:1.2em;font-style:italic}</style>
  </head>
  <body>
    <header class="c-navbar">
      <h1 class="c-navbar__title">
        <a href="/" class="c-navbar__title-link">Greg Tyler</a>
      </h1>
      <ul class="o-linklist o-linklist--horizontal">
        <li>
          <a href="/blog" class="o-linklist__link">Blog</a>
        </li>
        <li>
          <a href="/blog/category/weeknotes" class="o-linklist__link">Weeknotes</a>
        </li>
        <li>
          <a href="/portfolio" class="o-linklist__link">Portfolio</a>
        </li>
        <li>
          <a href="https://twitter.com/gregtyler" rel="me noreferrer" class="o-linklist__link">Twitter</a>
        </li>
      </ul>
    </header>
    
<main class="c-page t-flex--fill">
  <h1 class="c-page__title">When is a window closable?</h1>

  <div class="c-page__meta">
    <div>Published on 19th January 2015</div>
    
      <ul class="o-linklist o-linklist--centered">
        
          <li><a class="c-tag" href="/blog/category/webdev">Web development</a></li>
        
      </ul>
    
  </div>
  <div class="c-page__content"><p>JavaScript has a function <code>window.close()</code> which, under certain circumstances, will close the current window. However sometimes you&#39;ll run into an error like:   </p>
<blockquote>
<p>Scripts may close only the windows that were opened by it.</p>
</blockquote>
<p>In this situation, your helpful &quot;close this window&quot; buttons don&#39;t work.   </p>
<p>We have exactly this in situation in a current project I work on, where we ask people to open a link in a new tab so that <code>window.close()</code> will take them back out of it.   </p>
<p>The problem we had was knowing when <code>window.close()</code> will work. If you open a new window with JavaScript (using <code>window.open()</code> no less) then it you&#39;re fine. But if you right click and open in a new tab, then submit a form, it won&#39;t be happy. So when is a window closable?   </p>
<p>My first thought was the <code>opener</code> property of <code>window</code> which presumably would hint at where the window came from and &#8211; hence &#8211; what can close it. So I made a table of various difference situations which I experimented with in each of the major desktop browsers (Chrome, Firefox, IE). Find the table below and some terminology explained beneath it.   </p>
<table class="results-table">
<tbody>
<tr>
<th rowspan="2" style="width:25%"></th>
<th colspan="2" style="background-color:#DDD;">Chrome 39</th>
<th colspan="2" style="background-color:#F70;">Firefox 31</th>
<th colspan="2" style="background-color:#8DF;">Internet Explorer 11 \*</th>
</tr>
<tr>
<th>Click</th>
<th>New tab</th>
<th>Click</th>
<th>New tab</th>
<th>Click</th>
<th>New tab</th>
</tr>
<tr>
<th>Child</th>
<td class="bad">N</td>
<td>N</td>
<td class="bad">N</td>
<td class="bad">N</td>
<td>U</td>
<td>U</td>
</tr>
<tr>
<th>Child (\_blank)</th>
<td>W</td>
<td>W</td>
<td>W</td>
<td class="bad">N</td>
<td>W</td>
<td>U</td>
</tr>
<tr>
<th>Child (JS)</th>
<td colspan="2">W</td>
<td colspan="2">W</td>
<td colspan="2">W</td>
</tr>
<tr>
<th>Through form</th>
<td class="bad">N</td>
<td class="bad">N</td>
<td class="bad">N</td>
<td class="bad">N</td>
<td>U</td>
<td>U</td>
</tr>
<tr>
<th>Through form (\_blank)</th>
<td>W</td>
<td>W</td>
<td>W</td>
<td class="bad">N</td>
<td>W</td>
<td>U</td>
</tr>
<tr>
<th>Through form (JS)</th>
<td colspan="2">W</td>
<td colspan="2">W</td>
<td colspan="2">W</td>
</tr>
<tr>
<th>Through link</th>
<td class="bad">N</td>
<td class="bad">N</td>
<td class="bad">N</td>
<td class="bad">N</td>
<td>U</td>
<td>U</td>
</tr>
<tr>
<th>Through link (\_blank)</th>
<td>W</td>
<td>W</td>
<td>W</td>
<td class="bad">N</td>
<td>W</td>
<td>U</td>
</tr>
<tr>
<th>Through link (JS)</th>
<td colspan="2">W</td>
<td colspan="2">W</td>
<td colspan="2">W</td>
</tr>
</tbody>
</table>
<p><strong>Notes:</strong><br />&quot;Child&quot; means that the user was taken straight to a page with a close button on it. &quot;Through form&quot; means they were taken to a page which had a form submission before the close page. &quot;Through link&quot; means that they were taken to a page with a link to the close page.   </p>
<p>&quot;(_blank)&quot; means that the window was opened using an <code>&lt;a&gt;</code> tag with the <code>target=&quot;_blank&quot;</code> attribute. &quot;(JS)&quot; means that the window was opened with the <code>window.open</code> function. All other examples were <code>&lt;a&gt;</code> tags with no attributes.   </p>
<p>The colour of each cell is whether or not it could successfully be closed. The text denotes the value of <code>window.opener</code>. Where the text is &quot;N&quot;, this value was <code>null</code>, where it is &quot;W&quot; it returned a <code>window</code> object. Where it is &quot;U&quot;, it returned <code>undefined</code>.   </p>
<ul>
<li>Internet Explorer always prompts you to confirm the window closure.   </li>
</ul>
<h2 id="what-have-we-learnt-">What have we learnt?</h2>
<p>Firstly, Internet Explorer is noticeably unusual. It returns <code>undefined</code> rather than <code>null</code> and then lets you close the window no matter what situation you&#39;re in (though with a prompt). Secondly, and important for my situation, asking people to open a new tab doesn&#39;t mean we&#39;ll be able to close it. As soon as they follow a link or submit a form, both Firefox and Internet Explorer lose control.   </p>
<p>In a goal to find some sort of check whether a window is closable, I can recommend the following from my results:   </p>
<pre><code class="language-js"><span class="hljs-keyword">if</span>( <span class="hljs-keyword">typeof</span> <span class="hljs-built_in">window</span>.opener === <span class="hljs-string">'object'</span> &amp;&amp; <span class="hljs-built_in">window</span>.opener <span class="hljs-keyword">instanceof</span> Window ) {
    <span class="hljs-comment">// We can certainly use window.close</span>
} <span class="hljs-keyword">else</span> {
    <span class="hljs-comment">// We can't be sure window.close will work</span>
}</code></pre>
<p>This is (from the experience above) a cross-browser way to be certain that <code>window.close</code> will work, without any browser sniffing.   </p>
<p>Are my figures right? Any views on this? Comment below!</p>
<style type="text/css">.results-table {
width:100%;
border-collapse:collapse;
table-layout:fixed;
}
.results-table th, .results-table td {
padding:.5em;
border:1px solid #CCC;
text-align:center;
}
.results-table td {
background-color: #9D9;
color: darkgreen;
font-weight: bold;
}
.results-table td.bad {
background-color: #FD6E6E;
color: darkred;
}</style>
</div>
</main>

    <footer class="c-footer">
      🏛🌯🌳🎧
      <div>
        <a href="/privacy" class="c-footer__link">
          Privacy
        </a>
        <span role="separator">-</span>
        <a href="https://gitlab.com/gregtyler" rel="me noreferrer" class="c-footer__link">GitLab</a>
        <span role="separator">-</span>
        <a href="https://github.com/gregtyler" rel="me noreferrer" class="c-footer__link">GitHub</a>
      </div>
    </footer>

    <script type="text/javascript">
      // Analytics
      var _paq = _paq || [];
      _paq.push(['trackPageView']);
      _paq.push(['enableLinkTracking']);
      (function() {
        var u = "https://analytics.gregtyler.co.uk/";
        _paq.push(['setTrackerUrl', u+'piwik.php']);
        _paq.push(['setSiteId', '1']);
        var d=document, g=d.createElement('script'), s=d.getElementsByTagName('script')[0];
        g.type='text/javascript'; g.async=true; g.defer=true; g.src=u+'piwik.js'; s.parentNode.insertBefore(g,s);
      })();
    </script>
  </body>
</html>
